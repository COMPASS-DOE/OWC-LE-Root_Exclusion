setwd("C:/Users/readz/OneDrive - Smithsonian Institution/OWC-LE-Root_Exclusion/Porewater/Nutrients")
cat("Run Information: NAME ") #lets you know what section you're in
#set the run date & user name
run_date <- "08/20/2025"
sample_year <- "2024"
sample_month <- "Apr-May"
user <- "Roberta Peixoto"
#identify the files you want to read in
#read in as a list to accommadate ultiple runs in a month
data_files <- c("Raw Data/Seal_COMPASS_LE_OWC_RootExclusion_NUTR_Apr-May2024.csv")
# Define the file path for QAQC log file - NO Need to change just check year
file_path <- "Raw Data/SEAL_COMPASS_LE_OWC_RootExclusion_QAQC_Log_2025.csv"
final_path <- "Processed Data/COMPASS_LE_OWC_RootExclusion_Nutrients_2024_Apr-May2024.csv"
#record any notes about the run or anything other info here:
run_notes <- "Run notes that will give users info about issues
or any concerns.  "
#Set up file path for metadata
#downloaded metadata csv - downloaded from Google drive as csv for this year
Raw_Metadata = "Raw Data/COMPASS_OWC_Root_Exclusion_Nutrient_SampleLog.csv"
cat(run_notes)
#let you know which section you are in
cat("Setup")
#a link to the Gitbook or whatever protocol you are using for this analysis
#load/install packages
if (!require("pacman")) install.packages("pacman")
pacman::p_load(
dplyr,
purrr,
ggplot2,
ggpubr,
tidyr,
tidyverse,
lubridate,
tinytex,
stringr,
writexl,
readr,
readxl,
purrr,
tinytex,
broom)
#Coefficients / constants that are needed for calculations
N_mw <- 14.0067    # molecular weight of N
P_mw <- 30.973762  # molecular weight of P
Con1 <- 1000       # conversion factor value
Con2 <- 1000000    # conversion factor value
#Detection limit and top standards for flagging
NOx_dl <- 0.025  #mgL
NH3_dl <- 0.02  #mgL
PO4_dl <- 0.003 #mgL
NOx_top <- 1  #mgL
NH3_top <- 2  #mgL
PO4_top <- 0.3 #mgL
#Check Standard concentrations
NOx_CCV <- 0.5
NH3_CCV <- 1.0
PO4_CCV <- 0.15
#Spike Concentrations
NOx_Spk <- 0.5 #ppm or mg/L
NH3_Spk <- 1
PO4_Spk <- 0.152
#expected ranges for sample concentrations used for flags
r2_cutoff = 0.990
chk_flag = 0.25
chk_conc_flag = 15 #cutoff level for percent difference of check stds vs. expected concentration
chks_flag = 60
rep_flag = 25
#^this is a 25% error between samples
#blank_flag is calculated based on samples later in this code
#pe check Concentrations
NH3_pe <- 1.034
NOx_pe <- 1.51
PO4_pe <- 0.824
#read in the raw metadata file
raw_metadata <- read.csv(Raw_Metadata)
View(raw_metadata)
nutr_metadata <- raw_metadata
cat("Import Data")
#set file path for data - in run info chunk
path <- ("file path")
#Read in Raw Data
data <- map(data_files, read.csv)
#Read in Raw Data
data <- read.csv(data_files)
View(data)
# Rename columns
df_all <- data %>%
select(Sample_Name = 4,
Run_Number = 5,
Conc = 6,
Absorbance = 7,
Dilution = 9,
Unit = 12,
Test = 13,
Run_Time = 15) %>%
mutate(Run_Number = as.numeric(Run_Number))
